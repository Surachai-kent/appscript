<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>

<title>osax</title>

<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<style type="text/css" media="all"><!--@import url(../appscript-manual/full.css);--></style>

</head>
<body>

<h1>osax</h1>

<!-- top navigation -->
<div class="navbar">
    <a href="index.html">Up</a>
</div>

<!-- content -->
<div id="content">
<h2>What is osax?</h2>

<p>The <code>OSAX</code> module provides an easy way to call scripting additions (a.k.a. OSAXen) from Ruby. It exports a single public class, <code>ScriptingAddition</code>, and a single function, <code>scripting_additions</code>.</p>

<p>The <code>ScriptingAddition</code> class represents a single scripting addition. It is similar to an appscript application object, except that it defines commands for the specified scripting addition instead of the application's normal commands. </p>

<p>By default, a <code>ScriptingAddition</code> object is targetted at the current application. You can obtain a <code>ScriptingAddition</code> object targetted at another application by calling one of its <code>target...</code> methods.</p>

<p>Once you've created a <code>ScriptingAddition</code> instance, you can invoke its commands in exactly the same way as you would call a scriptable application's commands in appscript.</p>

<p>For example:</p>

<pre><code>require "osax"

sa = OSAX::ScriptingAddition.new("StandardAdditions")

sa.say("Hello world", :using=>"Victoria")</code></pre>

<p>The default application commands (<code>run</code>, <code>activate</code>, <code>quit</code>, etc.) are also available; see the appscript manual for details on those.</p>



<h2><code>OSAX.scripting_additions</code></h2>

<p>The <code>scripting_additions</code> function returns the names of all installed scripting additions:</p>

<pre><code>require "osax"

p OSAX.scripting_additions
# Result: ["Digital Hub Scripting", "StandardAdditions", ...]</code></pre>


<h2><code>OSAX::ScriptingAddition</code></h2>

<pre><code>ScriptingAddition -- represents a single scripting addition and its
        target application

    Constructors:

        ScriptingAddition.new(name) -- make a ScriptingAddition object
                for the specified scripting addition, targetted at the
                current application

    Methods:

        # Introspection:

        commands -- returns names of all available commands

        parameters(commandName) -- returns a command's parameter names

        # Specifying a different target application:

        # Each of the following methods returns a new ScriptingAddition
        # instance targetted at the specified application. The arguments
        # are the same as for the byName, byCreator, etc. methods in
        # appscript.
        
        targetName(name) -- name or full path of application, e.g. "Finder"

        targetCreator(creator) -- four-character creator code, e.g. "ttxt"

        targetID(id) -- bundle id, e.g. "com.apple.ical"

        targetPID(pid) -- Unix process ID, e.g. 4005

        targetURL(url) -- eppc URL, e.g. "eppc://jukebox-mac.local/iTunes"</code></pre>


<p class="hilitebox">Take care when using the osax module from the command line Ruby interpreter, which runs as a non-GUI process. Due to an OS limitation, commands such as <code>display_dialog</code> that require GUI access <em>must</em> be sent to a GUI process, otherwise a MacOSError (-1713, no user interaction allowed) will occur.</p>


<h2>Examples</h2>

<pre><code>require "osax"

# Create a new ScriptingAddition object:

sa = OSAX::ScriptingAddition.new("StandardAdditions")


# List all available commands:

p sa.commands
# Result: ["ASCII_character", "ASCII_number", "activate", ...]


# Call some commands:

sa.beep

p sa.path_to(:scripts_folder)
# Result: MacFile::Alias.at("/Users/foo/Library/Scripts/")


# Remember to target a GUI process when using dialog commands:

finder = sa.targetName("Finder")
finder.activate # bring Finder frontmost so user can see the dialog
p finder.display_dialog("Ruby says hello!",
                        :buttons => ["Hi!", "Howdy!", "Duuuude!"],
                        :default_button => 3)
# Result: {:button_returned=>"Howdy!"}</code></pre>


</div>

<!-- bottom navigation -->
<div class="navbar">
    <a href="index.html">Up</a>
</div>

<!--footer-->
<p class="footer">&copy; 2006 HAS</p>
</body>
</html>