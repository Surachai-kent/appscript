<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>

<title>aem | 6. Building and sending events</title>

<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<style type="text/css" media="all"><!--@import url(full.css);--></style>

</head>
<body>

<h1>6. Building and sending events</h1>

<!-- top navigation -->
<div class="navbar">
	<a href="05_targettingapplications.html">Previous</a> | <a href="index.html">Up</a> | <a href="07_findapp.html">Next</a>
</div>

<!-- content -->
<div id="content">




<h2>The <code>Application</code> class's <code>event</code> method</h2>

<pre><code>        event(event, params={}, atts={}, returnid=k.AutoGenerateReturnID,
                codecs=None) -- construct an Apple event
            event  : str -- 8-letter code indicating event's class and id,
                    e.g. 'coregetd'
            params : dict -- a dict of form {AE_code:anything,...} containing
                    zero or more event parameters (message arguments) [2]
            atts : dict -- a dict of form {AE_code:anything,...} containing
                    zero or more event attributes (event info) [3]
            returnid : int  -- reply event's ID
            codecs : Codecs | None -- custom codecs to use when packing/
                    unpacking this event; if None, codecs supplied in
                    Application constructor are used
            Result : Event -- a ready-to-send Apple event</code></pre>





<h2>The <code>Event</code> class</h2>


<pre><code>Event -- an Apple event that is ready to send

    Methods:
        _createAppleEvent(eventclass, eventid, address, returnid, transaction)
                -- Event subclasses may override this to modify AppleEvent
                descriptor creation; must return an AppleEvent descriptor [1]

        _sendAppleEvent(flags, timeout) -- Event subclasses may override this
            to modify event sending; must return an AppleEvent descriptor [1]

        send(timeout=k.DefaultTimeout, flags=k.WaitReply) -- send event
            timeout : int | k.DefaultTimeout | k.NoTimeout -- number of ticks
                    to wait for application reply before raising timeout error
            flags : int -- bitwise flags determining how event should be
                    handled [5]
            Result : anything -- value returned by application, if any</code></pre>



<p>[1] The Event class exposes two overrideable hooks, <code>_createAppleEvent</code> and <code>_sendAppleEvent</code>, allowing AppleEvent creation and/or sending to be modified by an aem client that needs to modify one or both of these steps (e.g. an OSA language component). The client-defined Event subclass should be stored in the <code>_Event</code> attribute of a client-defined Application subclass. The client should then instantiate their own Application subclass instead of aem's standard <code>Application</code> class to use the modified behaviour.</p>


[2] Following commonly used parameter keys are defined as constants:

kAE.keyDirectObject
kAE.keyAERequestedType

- Value for k.RequestedType parameter should be an instance of AEType

Other parameter keys are defined by application on a per-event basis.


[3] Attribute keys may be any of:
kAE.keyTransactionIDAttr
kAE.keyReturnIDAttr
kAE.keyEventClassAttr
kAE.keyEventIDAttr
kAE.keyAddressAttr
kAE.keyOptionalKeywordAttr
kAE.keyTimeoutAttr
kAE.keyInteractLevelAttr
kAE.keyEventSourceAttr
kAE.keyOriginalAddressAttr
kAE.keyAcceptTimeoutAttr
'cons' # ignore text attributes (note: deprecated in favour of 'csig')
'csig' # consider/ignore text attributes
'subj' # subject attribute

Note that some of these attributes are already supplied by other means (e.g. EventClass, EventID are specified in AECreateAppleEvent), and overriding them via the 'atts' argument could have unexpected results.

- Value for 'cons' attribute should be a list containing zero or more of: 

kAE.kAECase
kAE.kAEDiacritic
kAE.kAEWhiteSpace
kAE.kAEHyphens
kAE.kAEExpansion
kAE.kAEPunctuation
kAE.kAEZenkakuHankaku
kAE.kAESmallKana
kAE.kAEKataHiragana
kAE.kASConsiderReplies
kAE.kASNumericStrings

- See <http://developer.apple.com/documentation/Carbon/Reference/Apple_Event_Manager/index.html> for more info.



- Value for 'csig' attribute should be an integer composed from zero or more of the following bit masks:

  kAECaseConsiderMask
  kAEDiacriticConsiderMask
  kAEWhiteSpaceConsiderMask
  kAEHyphensConsiderMask
  kAEExpansionConsiderMask
  kAEPunctuationConsiderMask
  kASConsiderRepliesConsiderMask
  kASNumericStringsConsiderMask
  kAECaseIgnoreMask
  kAEDiacriticIgnoreMask
  kAEWhiteSpaceIgnoreMask
  kAEHyphensIgnoreMask
  kAEExpansionIgnoreMask
  kAEPunctuationIgnoreMask
  kASConsiderRepliesIgnoreMask
  kASNumericStringsIgnoreMask


[5] Send flag constants (bit masks):

kAENoReply
kAEQueueReply
kAEWaitReply

kAEDontReconnect

kAEWantReceipt

kAENeverInteract
kAECanInteract
kAEAlwaysInteract

kAECanSwitchLayer


See <http://developer.apple.com/documentation/Carbon/Reference/Apple_Event_Manager/apple_event_manager_ref/chapter_1.4_section_6.html> for details.



kAE.kAutoGenerateReturnID


<h2>The <code>CommandError</code> class</h2>


<pre><code>CommandError -- an error raised by target application or Apple Event Manager

    Attributes:
        number : int -- error number
        message : str | None -- error message, if any
        raw : dict of AEDesc -- raw reply data, in case alternate/additional
                processing of error info is required
        trace : str -- internal traceback (for debugging aem)</code></pre>

<!-- TO DO: MacOSError notes -->


</div>

<!-- bottom navigation -->
<div class="navbar">
	<a href="05_targettingapplications.html">Previous</a> | <a href="index.html">Up</a> | <a href="07_findapp.html">Next</a>
</div>

<!--footer-->
<p class="footer">&copy; 2006 HAS</p>
</body>
</html>